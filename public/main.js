'use strict';

var app = angular.module('App', ['ui.router', 'ngAnimate']);

app.config(function ($urlRouterProvider, $locationProvider) {
  $locationProvider.html5Mode(true);
  $urlRouterProvider.otherwise('/main');
});

app.run(function ($rootScope) {
  return $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, thrownError) {
    console.info('The following error was thrown by ui-router while transitioning to state "' + toState.name + '". The origin of this error is probably a resolve function:');
    console.error(thrownError);
  });
});

'use strict';

app.config(function ($stateProvider) {
  return $stateProvider.state('main', {
    url: '/main',
    views: {
      '': { templateUrl: 'src/templates/main.template.html', conroller: 'MainCtrl' },
      'bg@main': { templateUrl: 'src/templates/bg.template.html' },
      'form@main': { templateUrl: 'src/templates/form.template.html', controller: 'MainCtrl' },
      'footer@main': { templateUrl: 'src/templates/footer.template.html' }
    }
  });
});
'use strict';

app.controller('MainCtrl', function ($scope, RateFactory, LoanFactory) {

  RateFactory.fetch_rates().then(function (data) {
    return $scope.rates = data;
  });

  $scope.default_loan_form = { amount: '', start_month: '', number_of_months: '', custom_rate: '', federal_rate: '', federal: '', custom: '' };
  $scope.default_loan_schedule = [];
  $scope.default_result = { est_payment: '', subtotal_principal: '', subtotal_interest: '' };

  $scope.reset = function () {
    $scope.loan = angular.copy($scope.default_loan_form);
    $scope.schedule = angular.copy($scope.default_loan_schedule);
    $scope.result = angular.copy($scope.default_result);
    $scope.show_loan_schedule = false;
    $scope.loan_start_month_warning = '';
    $scope.loan_rate_error = '';
    $scope.loan_rate_warning = '';
    if ($scope.form) {
      $scope.form.$setPristine();
      $scope.form.$setUntouched();
    }
  };
  $scope.reset();

  $scope.update = function () {
    //TODO: money value format // const format = (n, currency) => currency + " " + Number(n).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
    $scope.validate_loan_rate();
    $scope.calculate_schedule();
  };

  $scope.toggle_show_loan_schedule = function () {
    if ($scope.schedule.length > 0) $scope.show_loan_schedule = !$scope.show_loan_schedule;
  };

  $scope.open_loan_schedule = function () {
    if ($scope.schedule.length > 0 && $scope.show_loan_schedule == true) return true;else return false;
  };

  $scope.validate_loan_rate = function () {
    $scope.loan_start_month_warning = '';
    $scope.loan_rate_error = '';
    $scope.loan_rate_warning = '';
    var _$scope$form = $scope.form,
        custom = _$scope$form.custom,
        federal = _$scope$form.federal,
        start = _$scope$form.start; // error validation

    var _$scope$loan = $scope.loan,
        custom_rate = _$scope$loan.custom_rate,
        federal_rate = _$scope$loan.federal_rate,
        start_month = _$scope$loan.start_month; // form values

    if (start.$touched && !start_month) $scope.loan_start_month_warning = 'If you don\'t choose a starting month, current month will be applied';
    if (custom.$pristine && federal.$pristine) $scope.loan_rate_error = '';else {
      if ((!custom_rate || custom_rate <= 0) && !federal_rate) $scope.loan_rate_error = 'Please either fill out the custom rate or select an option';
      if (custom_rate > 0 && federal_rate) $scope.loan_rate_warning = 'If you choose both interests, custom interest will be applied';
    }
  };

  $scope.calculate_schedule = function () {
    var _$scope$loan2 = $scope.loan,
        amount = _$scope$loan2.amount,
        start_month = _$scope$loan2.start_month,
        number_of_months = _$scope$loan2.number_of_months,
        custom_rate = _$scope$loan2.custom_rate,
        federal_rate = _$scope$loan2.federal_rate;

    if (+amount > 0 && +number_of_months > 0 && (+custom_rate > 0 || federal_rate > 0)) {
      $scope.schedule = LoanFactory.calculate_schedule($scope.loan);
      $scope.subtotal_payment = $scope.schedule.map(function (s) {
        return +s.payment;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);
      $scope.subtotal_principal = $scope.schedule.map(function (s) {
        return +s.principal;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);
      $scope.subtotal_interest = $scope.schedule.map(function (s) {
        return +s.interest;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);

      $scope.result.est_payment = $scope.schedule[0].payment;
      $scope.result.subtotal_principal = $scope.subtotal_principal;
      $scope.result.subtotal_interest = $scope.subtotal_interest;
    }
  };
});
'use strict';

app.factory('LoanFactory', function ($http, $log) {

  var calculate_schedule = function calculate_schedule(loan) {
    var d = new Date();
    var default_start_month = d.setDate(d.getMonth() + 1);
    var u = new Date(default_start_month);
    if (!loan.start_month) loan.start_month = u;

    var schedule = [];
    var m = +loan.number_of_months;
    var amount = +loan.amount;
    var r = +loan.custom_rate > 0 ? +loan.custom_rate / 100 : +loan.federal_rate;

    var annuity_factor = (1 - 1 / Math.pow(1 + r / 12, m)) / (r / 12);
    var pmt = amount / annuity_factor;

    var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    var balance = amount;
    var paid_principal = 0;
    var y = 0;
    for (var i = 0; i < m; i++) {
      if ((loan.start_month.getMonth() + i) % 12 == 11) y += 1;
      var year = loan.start_month.getFullYear() + y;
      var month = months[(loan.start_month.getMonth() + i + 1) % 12] + '-' + year;

      if (i == m - 1) {
        var interest = (balance * (r / 12)).toFixed(2);
        var principal = (amount - paid_principal).toFixed(2);
        var payment = (Number(interest) + Number(principal)).toFixed(2);
        balance = 0;
        schedule.push({ month: month, payment: payment, principal: principal, interest: interest, balance: balance });
      } else {
        var _payment = pmt.toFixed(2);
        var _interest = (balance * (r / 12)).toFixed(2);
        var _principal = (_payment - balance * (r / 12)).toFixed(2);
        paid_principal += Number(_principal);
        balance = (balance - _principal).toFixed(2);
        schedule.push({ month: month, payment: _payment, principal: _principal, interest: _interest, balance: balance });
      }
    }
    return schedule;
  };

  return { calculate_schedule: calculate_schedule };
});

'use strict';

app.factory('RateFactory', function ($http, $log) {
  var rates = [];

  var fetch_rates = function fetch_rates() {
    if (rates.length == 0) return $http.get('/api/rates').then(function (res) {
      return rates = res.data;
    });else if (new Date() - rates[0].updated_at > 24 * 60 * 60 * 1000) return $http.get('/api/rates').then(function (res) {
      return rates = res.data;
    });
    return rates;
  };

  return { fetch_rates: fetch_rates };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInN0YXRlcy5qcyIsImNvbnRyb2xsZXJzL21haW4uY29udHJvbGxlci5qcyIsImZhY3Rvcmllcy9sb2FuLmZhY3RvcnkuanMiLCJmYWN0b3JpZXMvcmF0ZS5mYWN0b3J5LmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsInJ1biIsIiRyb290U2NvcGUiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJ0aHJvd25FcnJvciIsImNvbnNvbGUiLCJpbmZvIiwibmFtZSIsImVycm9yIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsInZpZXdzIiwidGVtcGxhdGVVcmwiLCJjb25yb2xsZXIiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiUmF0ZUZhY3RvcnkiLCJMb2FuRmFjdG9yeSIsImZldGNoX3JhdGVzIiwidGhlbiIsInJhdGVzIiwiZGF0YSIsImRlZmF1bHRfbG9hbl9mb3JtIiwiYW1vdW50Iiwic3RhcnRfbW9udGgiLCJudW1iZXJfb2ZfbW9udGhzIiwiY3VzdG9tX3JhdGUiLCJmZWRlcmFsX3JhdGUiLCJmZWRlcmFsIiwiY3VzdG9tIiwiZGVmYXVsdF9sb2FuX3NjaGVkdWxlIiwiZGVmYXVsdF9yZXN1bHQiLCJlc3RfcGF5bWVudCIsInN1YnRvdGFsX3ByaW5jaXBhbCIsInN1YnRvdGFsX2ludGVyZXN0IiwicmVzZXQiLCJsb2FuIiwiY29weSIsInNjaGVkdWxlIiwicmVzdWx0Iiwic2hvd19sb2FuX3NjaGVkdWxlIiwibG9hbl9zdGFydF9tb250aF93YXJuaW5nIiwibG9hbl9yYXRlX2Vycm9yIiwibG9hbl9yYXRlX3dhcm5pbmciLCJmb3JtIiwiJHNldFByaXN0aW5lIiwiJHNldFVudG91Y2hlZCIsInVwZGF0ZSIsInZhbGlkYXRlX2xvYW5fcmF0ZSIsImNhbGN1bGF0ZV9zY2hlZHVsZSIsInRvZ2dsZV9zaG93X2xvYW5fc2NoZWR1bGUiLCJsZW5ndGgiLCJvcGVuX2xvYW5fc2NoZWR1bGUiLCJzdGFydCIsIiR0b3VjaGVkIiwiJHByaXN0aW5lIiwic3VidG90YWxfcGF5bWVudCIsIm1hcCIsInMiLCJwYXltZW50IiwicmVkdWNlIiwicHJldiIsImN1cnIiLCJwcmluY2lwYWwiLCJpbnRlcmVzdCIsImZhY3RvcnkiLCIkaHR0cCIsIiRsb2ciLCJkIiwiRGF0ZSIsImRlZmF1bHRfc3RhcnRfbW9udGgiLCJzZXREYXRlIiwiZ2V0TW9udGgiLCJ1IiwibSIsInIiLCJhbm51aXR5X2ZhY3RvciIsIk1hdGgiLCJwb3ciLCJwbXQiLCJtb250aHMiLCJiYWxhbmNlIiwicGFpZF9wcmluY2lwYWwiLCJ5IiwiaSIsInllYXIiLCJnZXRGdWxsWWVhciIsIm1vbnRoIiwidG9GaXhlZCIsIk51bWJlciIsInB1c2giLCJnZXQiLCJyZXMiLCJ1cGRhdGVkX2F0Il0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLE1BQUFDLFFBQUFDLE1BQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQSxXQUFBLEVBQUEsV0FBQSxDQUFBLENBQUE7O0FBRUFGLElBQUFHLE1BQUEsQ0FBQSxVQUFBQyxrQkFBQSxFQUFBQyxpQkFBQSxFQUFBO0FBQ0FBLG9CQUFBQyxTQUFBLENBQUEsSUFBQTtBQUNBRixxQkFBQUcsU0FBQSxDQUFBLE9BQUE7QUFDQSxDQUhBOztBQUtBUCxJQUFBUSxHQUFBLENBQUEsVUFBQUMsVUFBQTtBQUFBLFNBQ0FBLFdBQUFDLEdBQUEsQ0FBQSxtQkFBQSxFQUFBLFVBQUFDLEtBQUEsRUFBQUMsT0FBQSxFQUFBQyxRQUFBLEVBQUFDLFNBQUEsRUFBQUMsVUFBQSxFQUFBQyxXQUFBLEVBQUE7QUFDQUMsWUFBQUMsSUFBQSxnRkFBQU4sUUFBQU8sSUFBQTtBQUNBRixZQUFBRyxLQUFBLENBQUFKLFdBQUE7QUFDQSxHQUhBLENBREE7QUFBQSxD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QUEsQ0FBQSxFQUFBLE9BQUFlLE1BQUF5QixHQUFBLENBQUEsWUFBQSxFQUFBeEUsSUFBQSxDQUFBO0FBQUEsYUFBQUMsUUFBQXdFLElBQUF2RSxJQUFBO0FBQUEsS0FBQSxDQUFBLENBQUEsS0FDQSxJQUFBLElBQUFnRCxJQUFBLEtBQUFqRCxNQUFBLENBQUEsRUFBQXlFLFVBQUEsR0FBQSxLQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsSUFBQSxFQUFBLE9BQUEzQixNQUFBeUIsR0FBQSxDQUFBLFlBQUEsRUFBQXhFLElBQUEsQ0FBQTtBQUFBLGFBQUFDLFFBQUF3RSxJQUFBdkUsSUFBQTtBQUFBLEtBQUEsQ0FBQTtBQUNBLFdBQUFELEtBQUE7QUFDQSxHQUpBOztBQU1BLFNBQUEsRUFBQUYsd0JBQUEsRUFBQTtBQUNBLENBVkEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHAnLCBbJ3VpLnJvdXRlcicsICduZ0FuaW1hdGUnXSk7XG5cbmFwcC5jb25maWcoKCR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpID0+IHtcbiAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvbWFpbicpO1xufSlcblxuYXBwLnJ1bigoJHJvb3RTY29wZSkgPT5cbiAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCB0aHJvd25FcnJvcikgPT4ge1xuICAgIGNvbnNvbGUuaW5mbyhgVGhlIGZvbGxvd2luZyBlcnJvciB3YXMgdGhyb3duIGJ5IHVpLXJvdXRlciB3aGlsZSB0cmFuc2l0aW9uaW5nIHRvIHN0YXRlIFwiJHt0b1N0YXRlLm5hbWV9XCIuIFRoZSBvcmlnaW4gb2YgdGhpcyBlcnJvciBpcyBwcm9iYWJseSBhIHJlc29sdmUgZnVuY3Rpb246YCk7XG4gICAgY29uc29sZS5lcnJvcih0aHJvd25FcnJvcik7XG4gIH0pXG4pXG4iLCIndXNlIHN0cmljdCdcblxuYXBwLmNvbmZpZygoJHN0YXRlUHJvdmlkZXIpID0+XG4gICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdtYWluJywge1xuICAgIHVybDogJy9tYWluJyxcbiAgICB2aWV3czoge1xuICAgICAgJyc6IHsgdGVtcGxhdGVVcmw6ICdzcmMvdGVtcGxhdGVzL21haW4udGVtcGxhdGUuaHRtbCcsIGNvbnJvbGxlcjogJ01haW5DdHJsJ30sXG4gICAgICAnYmdAbWFpbic6IHt0ZW1wbGF0ZVVybDogJ3NyYy90ZW1wbGF0ZXMvYmcudGVtcGxhdGUuaHRtbCd9LFxuICAgICAgJ2Zvcm1AbWFpbic6IHt0ZW1wbGF0ZVVybDogJ3NyYy90ZW1wbGF0ZXMvZm9ybS50ZW1wbGF0ZS5odG1sJywgY29udHJvbGxlcjogJ01haW5DdHJsJ30sXG4gICAgICAnZm9vdGVyQG1haW4nOiB7IHRlbXBsYXRlVXJsOiAnc3JjL3RlbXBsYXRlcy9mb290ZXIudGVtcGxhdGUuaHRtbCcgfVxuICAgIH1cbiAgfSlcbikiLCIndXNlIHN0cmljdCdcblxuYXBwLmNvbnRyb2xsZXIoJ01haW5DdHJsJywgKCRzY29wZSwgUmF0ZUZhY3RvcnksIExvYW5GYWN0b3J5KSA9PiB7XG5cbiAgUmF0ZUZhY3RvcnkuZmV0Y2hfcmF0ZXMoKS50aGVuKGRhdGEgPT4gJHNjb3BlLnJhdGVzID0gZGF0YSk7XG5cbiAgJHNjb3BlLmRlZmF1bHRfbG9hbl9mb3JtID0geyBhbW91bnQ6ICcnLCBzdGFydF9tb250aDogJycsIG51bWJlcl9vZl9tb250aHM6ICcnLCBjdXN0b21fcmF0ZTogJycsIGZlZGVyYWxfcmF0ZTogJycsIGZlZGVyYWw6ICcnLCBjdXN0b206ICcnIH07XG4gICRzY29wZS5kZWZhdWx0X2xvYW5fc2NoZWR1bGUgPSBbXTtcbiAgJHNjb3BlLmRlZmF1bHRfcmVzdWx0ID0geyBlc3RfcGF5bWVudDogJycsIHN1YnRvdGFsX3ByaW5jaXBhbDogJycsIHN1YnRvdGFsX2ludGVyZXN0OiAnJ307XG5cblxuICAkc2NvcGUucmVzZXQgPSAoKSA9PiB7XG4gICAgJHNjb3BlLmxvYW4gPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmRlZmF1bHRfbG9hbl9mb3JtKTtcbiAgICAkc2NvcGUuc2NoZWR1bGUgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmRlZmF1bHRfbG9hbl9zY2hlZHVsZSk7XG4gICAgJHNjb3BlLnJlc3VsdCA9IGFuZ3VsYXIuY29weSgkc2NvcGUuZGVmYXVsdF9yZXN1bHQpO1xuICAgICRzY29wZS5zaG93X2xvYW5fc2NoZWR1bGUgPSBmYWxzZTtcbiAgICAkc2NvcGUubG9hbl9zdGFydF9tb250aF93YXJuaW5nID0gJyc7XG4gICAgJHNjb3BlLmxvYW5fcmF0ZV9lcnJvciA9ICcnO1xuICAgICRzY29wZS5sb2FuX3JhdGVfd2FybmluZyA9ICcnO1xuICAgIGlmICgkc2NvcGUuZm9ybSkge1xuICAgICAgJHNjb3BlLmZvcm0uJHNldFByaXN0aW5lKCk7XG4gICAgICAkc2NvcGUuZm9ybS4kc2V0VW50b3VjaGVkKCk7XG4gICAgfVxuICB9XG4gICRzY29wZS5yZXNldCgpO1xuXG4gICRzY29wZS51cGRhdGUgPSAoKSA9PiB7XG4gICAgLy9UT0RPOiBtb25leSB2YWx1ZSBmb3JtYXQgLy8gY29uc3QgZm9ybWF0ID0gKG4sIGN1cnJlbmN5KSA9PiBjdXJyZW5jeSArIFwiIFwiICsgTnVtYmVyKG4pLnRvRml4ZWQoMikucmVwbGFjZSgvKFxcZCkoPz0oXFxkezN9KStcXC4pL2csICckMSwnKTtcbiAgICAkc2NvcGUudmFsaWRhdGVfbG9hbl9yYXRlKCk7XG4gICAgJHNjb3BlLmNhbGN1bGF0ZV9zY2hlZHVsZSgpO1xuICB9XG5cbiAgJHNjb3BlLnRvZ2dsZV9zaG93X2xvYW5fc2NoZWR1bGUgPSAoKSA9PiB7XG4gICAgaWYgKCRzY29wZS5zY2hlZHVsZS5sZW5ndGggPiAwKSAkc2NvcGUuc2hvd19sb2FuX3NjaGVkdWxlID0gISRzY29wZS5zaG93X2xvYW5fc2NoZWR1bGU7XG4gIH1cblxuICAkc2NvcGUub3Blbl9sb2FuX3NjaGVkdWxlID0gKCkgPT4ge1xuICAgIGlmICgkc2NvcGUuc2NoZWR1bGUubGVuZ3RoID4gMCAmJiAkc2NvcGUuc2hvd19sb2FuX3NjaGVkdWxlID09IHRydWUpIHJldHVybiB0cnVlO1xuICAgIGVsc2UgcmV0dXJuIGZhbHNlO1xuICB9XG5cblxuICAkc2NvcGUudmFsaWRhdGVfbG9hbl9yYXRlID0gKCkgPT4ge1xuICAgICRzY29wZS5sb2FuX3N0YXJ0X21vbnRoX3dhcm5pbmcgPSAnJztcbiAgICAkc2NvcGUubG9hbl9yYXRlX2Vycm9yID0gJyc7XG4gICAgJHNjb3BlLmxvYW5fcmF0ZV93YXJuaW5nID0gJyc7XG4gICAgY29uc3QgeyBjdXN0b20sIGZlZGVyYWwsIHN0YXJ0IH0gPSAkc2NvcGUuZm9ybTsgLy8gZXJyb3IgdmFsaWRhdGlvblxuICAgIGNvbnN0IHsgY3VzdG9tX3JhdGUsIGZlZGVyYWxfcmF0ZSwgc3RhcnRfbW9udGggfSA9ICRzY29wZS5sb2FuOyAvLyBmb3JtIHZhbHVlc1xuXG4gICAgaWYgKHN0YXJ0LiR0b3VjaGVkICYmICFzdGFydF9tb250aCkgJHNjb3BlLmxvYW5fc3RhcnRfbW9udGhfd2FybmluZyA9IGBJZiB5b3UgZG9uJ3QgY2hvb3NlIGEgc3RhcnRpbmcgbW9udGgsIGN1cnJlbnQgbW9udGggd2lsbCBiZSBhcHBsaWVkYFxuICAgIGlmIChjdXN0b20uJHByaXN0aW5lICYmIGZlZGVyYWwuJHByaXN0aW5lKSAkc2NvcGUubG9hbl9yYXRlX2Vycm9yID0gJyc7XG4gICAgZWxzZSB7XG4gICAgICBpZiAoKCFjdXN0b21fcmF0ZSB8fCBjdXN0b21fcmF0ZSA8PSAwKSAmJiAhZmVkZXJhbF9yYXRlKSAkc2NvcGUubG9hbl9yYXRlX2Vycm9yID0gJ1BsZWFzZSBlaXRoZXIgZmlsbCBvdXQgdGhlIGN1c3RvbSByYXRlIG9yIHNlbGVjdCBhbiBvcHRpb24nO1xuICAgICAgaWYgKGN1c3RvbV9yYXRlID4gMCAmJiBmZWRlcmFsX3JhdGUpICRzY29wZS5sb2FuX3JhdGVfd2FybmluZyA9ICdJZiB5b3UgY2hvb3NlIGJvdGggaW50ZXJlc3RzLCBjdXN0b20gaW50ZXJlc3Qgd2lsbCBiZSBhcHBsaWVkJztcbiAgICB9XG4gIH1cblxuICAkc2NvcGUuY2FsY3VsYXRlX3NjaGVkdWxlID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgYW1vdW50LCBzdGFydF9tb250aCwgbnVtYmVyX29mX21vbnRocywgY3VzdG9tX3JhdGUsIGZlZGVyYWxfcmF0ZSB9ID0gJHNjb3BlLmxvYW47XG4gICAgaWYgKCthbW91bnQgPiAwICYmICtudW1iZXJfb2ZfbW9udGhzID4gMCAmJiAoK2N1c3RvbV9yYXRlID4gMCB8fCBmZWRlcmFsX3JhdGUgPiAwKSApIHtcbiAgICAgICRzY29wZS5zY2hlZHVsZSA9IExvYW5GYWN0b3J5LmNhbGN1bGF0ZV9zY2hlZHVsZSgkc2NvcGUubG9hbik7XG4gICAgICAkc2NvcGUuc3VidG90YWxfcGF5bWVudCA9ICRzY29wZS5zY2hlZHVsZS5tYXAocyA9PiArcy5wYXltZW50KS5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IHByZXYgKyBjdXJyLCAwKTtcbiAgICAgICRzY29wZS5zdWJ0b3RhbF9wcmluY2lwYWwgPSAkc2NvcGUuc2NoZWR1bGUubWFwKHMgPT4gK3MucHJpbmNpcGFsKS5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IHByZXYgKyBjdXJyLCAwKTtcbiAgICAgICRzY29wZS5zdWJ0b3RhbF9pbnRlcmVzdCA9ICRzY29wZS5zY2hlZHVsZS5tYXAocyA9PiArcy5pbnRlcmVzdCkucmVkdWNlKChwcmV2LCBjdXJyKSA9PiBwcmV2ICsgY3VyciwgMCk7XG5cbiAgICAgICRzY29wZS5yZXN1bHQuZXN0X3BheW1lbnQgPSAkc2NvcGUuc2NoZWR1bGVbMF0ucGF5bWVudDtcbiAgICAgICRzY29wZS5yZXN1bHQuc3VidG90YWxfcHJpbmNpcGFsID0gJHNjb3BlLnN1YnRvdGFsX3ByaW5jaXBhbDtcbiAgICAgICRzY29wZS5yZXN1bHQuc3VidG90YWxfaW50ZXJlc3QgPSAkc2NvcGUuc3VidG90YWxfaW50ZXJlc3Q7XG5cbiAgICB9XG5cbiAgfVxuXG59KSIsIid1c2Ugc3RyaWN0J1xuXG5hcHAuZmFjdG9yeSgnTG9hbkZhY3RvcnknLCAoJGh0dHAsICRsb2cpID0+IHtcblxuICBjb25zdCBjYWxjdWxhdGVfc2NoZWR1bGUgPSAobG9hbikgPT4ge1xuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRlZmF1bHRfc3RhcnRfbW9udGggPSBkLnNldERhdGUoZC5nZXRNb250aCgpICsgMSk7XG4gICAgY29uc3QgdSA9IG5ldyBEYXRlKGRlZmF1bHRfc3RhcnRfbW9udGgpXG4gICAgaWYgKCFsb2FuLnN0YXJ0X21vbnRoKSBsb2FuLnN0YXJ0X21vbnRoID0gdTtcblxuICAgIGxldCBzY2hlZHVsZSA9IFtdO1xuICAgIGxldCBtID0gK2xvYW4ubnVtYmVyX29mX21vbnRocztcbiAgICBsZXQgYW1vdW50ID0gK2xvYW4uYW1vdW50O1xuICAgIGxldCByID0gK2xvYW4uY3VzdG9tX3JhdGUgPiAwID8gK2xvYW4uY3VzdG9tX3JhdGUgLyAxMDAgOiArbG9hbi5mZWRlcmFsX3JhdGU7XG5cbiAgICBjb25zdCBhbm51aXR5X2ZhY3RvciA9ICggMSAtICggMSAvIE1hdGgucG93KDEgKyByIC8gMTIsIG0pICkgKSAvIChyIC8gMTIpO1xuICAgIGNvbnN0IHBtdCA9IGFtb3VudCAvIGFubnVpdHlfZmFjdG9yO1xuXG4gICAgY29uc3QgbW9udGhzID0gWydKYW51YXJ5JywgJ0ZlYnJ1YXJ5JywgJ01hcmNoJywgJ0FwcmlsJywgJ01heScsICdKdW5lJywgJ0p1bHknLCAnQXVndXN0JywgJ1NlcHRlbWJlcicsICdPY3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJ107XG4gICAgbGV0IGJhbGFuY2UgPSBhbW91bnQ7XG4gICAgbGV0IHBhaWRfcHJpbmNpcGFsID0gMDtcbiAgICBsZXQgeSA9IDA7XG4gICAgZm9yKHZhciBpPTA7IGk8bTsgaSsrKSB7XG4gICAgICBpZiAoIChsb2FuLnN0YXJ0X21vbnRoLmdldE1vbnRoKCkgKyBpKSAlIDEyID09IDExICkgeSArPTE7XG4gICAgICBsZXQgeWVhciA9IGxvYW4uc3RhcnRfbW9udGguZ2V0RnVsbFllYXIoKSArIHkgO1xuICAgICAgbGV0IG1vbnRoID0gYCR7bW9udGhzWyhsb2FuLnN0YXJ0X21vbnRoLmdldE1vbnRoKCkgKyBpKzEpICUgMTIgXX0tJHt5ZWFyfWA7XG5cbiAgICAgIGlmIChpID09IG0tMSkge1xuICAgICAgICBsZXQgaW50ZXJlc3QgPSAoYmFsYW5jZSAqIChyIC8gMTIpKS50b0ZpeGVkKDIpO1xuICAgICAgICBsZXQgcHJpbmNpcGFsID0gKGFtb3VudCAtIHBhaWRfcHJpbmNpcGFsKS50b0ZpeGVkKDIpO1xuICAgICAgICBsZXQgcGF5bWVudCA9IChOdW1iZXIoaW50ZXJlc3QpICsgTnVtYmVyKHByaW5jaXBhbCkpLnRvRml4ZWQoMik7XG4gICAgICAgIGJhbGFuY2UgPSAwO1xuICAgICAgICBzY2hlZHVsZS5wdXNoKHsgbW9udGgsIHBheW1lbnQsIHByaW5jaXBhbCwgaW50ZXJlc3QsIGJhbGFuY2UgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBwYXltZW50ID0gcG10LnRvRml4ZWQoMik7XG4gICAgICAgIGxldCBpbnRlcmVzdCA9IChiYWxhbmNlICogKHIgLyAxMikpLnRvRml4ZWQoMik7XG4gICAgICAgIGxldCBwcmluY2lwYWwgPSAocGF5bWVudCAtIGJhbGFuY2UgKiAociAvIDEyKSkudG9GaXhlZCgyKTtcbiAgICAgICAgcGFpZF9wcmluY2lwYWwgKz0gTnVtYmVyKHByaW5jaXBhbCk7XG4gICAgICAgIGJhbGFuY2UgPSAoYmFsYW5jZSAtIHByaW5jaXBhbCkudG9GaXhlZCgyKTtcbiAgICAgICAgc2NoZWR1bGUucHVzaCh7IG1vbnRoLCBwYXltZW50LCBwcmluY2lwYWwsIGludGVyZXN0LCBiYWxhbmNlIH0pXG4gICAgICB9XG5cbiAgICB9XG4gICAgcmV0dXJuIHNjaGVkdWxlO1xuICB9XG5cblxuICByZXR1cm4geyBjYWxjdWxhdGVfc2NoZWR1bGUgfVxufSlcbiIsIid1c2Ugc3RyaWN0J1xuXG5hcHAuZmFjdG9yeSgnUmF0ZUZhY3RvcnknLCAoJGh0dHAsICRsb2cpID0+IHtcbiAgbGV0IHJhdGVzID0gW107XG5cbiAgY29uc3QgZmV0Y2hfcmF0ZXMgPSAoKSA9PiB7XG4gICAgaWYgKHJhdGVzLmxlbmd0aCA9PSAwKSByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3JhdGVzJykudGhlbihyZXMgPT4gcmF0ZXMgPSByZXMuZGF0YSk7XG4gICAgZWxzZSBpZiAobmV3IERhdGUgLSByYXRlc1swXS51cGRhdGVkX2F0ID4gMjQgKiA2MCAqIDYwICogMTAwMCkgcmV0dXJuICRodHRwLmdldCgnL2FwaS9yYXRlcycpLnRoZW4ocmVzID0+IHJhdGVzID0gcmVzLmRhdGEpO1xuICAgIHJldHVybiByYXRlcztcbiAgfVxuXG4gIHJldHVybiB7IGZldGNoX3JhdGVzIH1cbn0pXG4iXX0=
