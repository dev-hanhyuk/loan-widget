'use strict';

var app = angular.module('App', ['ui.router', 'ngAnimate']);

app.config(function ($urlRouterProvider, $locationProvider) {
  $locationProvider.html5Mode(true);
  $urlRouterProvider.otherwise('/main');
});

app.run(function ($rootScope) {
  return $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, thrownError) {
    console.info('The following error was thrown by ui-router while transitioning to state "' + toState.name + '". The origin of this error is probably a resolve function:');
    console.error(thrownError);
  });
});

'use strict';

app.config(function ($stateProvider) {
  return $stateProvider.state('main', {
    url: '/main',
    views: {
      '': { templateUrl: 'src/templates/main.template.html', conroller: 'MainCtrl' },
      'bg@main': { templateUrl: 'src/templates/bg.template.html' },
      'intro@main': { templateUrl: 'src/templates/intro.template.html' },
      'form@main': { templateUrl: 'src/templates/form.template.html', controller: 'MainCtrl' },
      'footer@main': { templateUrl: 'src/templates/footer.template.html' }
    }
  });
});
'use strict';

app.factory('LoanFactory', function ($http, $log) {

  var calculate_schedule = function calculate_schedule(loan) {
    var d = new Date();
    var default_start_month = d.setDate(d.getMonth() + 1);
    var u = new Date(default_start_month);
    if (!loan.start_month) loan.start_month = u;

    var schedule = [];
    var m = +loan.number_of_months;
    var amount = +loan.amount;
    var r = +loan.custom_rate > 0 ? +loan.custom_rate / 100 : +loan.federal_rate;
    var annuity_factor = (1 - 1 / Math.pow(1 + r / m, m)) / (r / m);
    var pmt = amount / annuity_factor;
    var months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

    var balance = amount;
    var paid_principal = 0;
    var y = 0;
    for (var i = 0; i < m; i++) {
      if ((loan.start_month.getMonth() + i) % 12 == 11) y += 1;
      var year = loan.start_month.getFullYear() + y;
      var month = months[(loan.start_month.getMonth() + i + 1) % 12] + '-' + year;
      if (i == m - 1) {
        var interest = (balance * (r / m)).toFixed(2);
        var principal = (amount - paid_principal).toFixed(2);
        var payment = (Number(interest) + Number(principal)).toFixed(2);
        balance = 0;
        schedule.push({ month: month, payment: payment, principal: principal, interest: interest, balance: balance });
      } else {

        var _payment = pmt.toFixed(2);
        var _interest = (balance * (r / m)).toFixed(2);
        var _principal = (_payment - balance * (r / m)).toFixed(2);
        paid_principal += Number(_principal);
        balance = (balance - _principal).toFixed(2);
        schedule.push({ month: month, payment: _payment, principal: _principal, interest: _interest, balance: balance });
      }
    }
    return schedule;
  };

  return { calculate_schedule: calculate_schedule };
});

'use strict';

app.factory('RateFactory', function ($http, $log) {
  var rates = [];

  var fetch_rates = function fetch_rates() {
    if (rates.length == 0) return $http.get('/api/rates').then(function (res) {
      return rates = res.data;
    });else if (new Date() - rates[0].updated_at > 24 * 60 * 60 * 1000) return $http.get('/api/rates').then(function (res) {
      return rates = res.data;
    });
    return rates;
  };

  return { fetch_rates: fetch_rates };
});

'use strict';

app.controller('MainCtrl', function ($scope, RateFactory, LoanFactory) {

  RateFactory.fetch_rates().then(function (data) {
    return $scope.rates = data;
  });

  $scope.default_loan_form = { amount: '', start_month: '', number_of_months: '', custom_rate: '', federal_rate: '', federal: '', custom: '' };
  $scope.default_loan_schedule = [];
  $scope.default_result = { est_payment: '', subtotal_principal: '', subtotal_interest: '' };

  $scope.reset = function () {
    $scope.loan = angular.copy($scope.default_loan_form);
    $scope.schedule = angular.copy($scope.default_loan_schedule);
    $scope.result = angular.copy($scope.default_result);
    $scope.show_loan_schedule = false;
    $scope.loan_start_month_warning = '';
    $scope.loan_rate_error = '';
    $scope.loan_rate_warning = '';
    if ($scope.form) {
      $scope.form.$setPristine();
      $scope.form.$setUntouched();
    }
  };
  $scope.reset();

  $scope.update = function () {
    //TODO: money value format // const format = (n, currency) => currency + " " + Number(n).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');
    $scope.validate_loan_rate();
    $scope.calculate_schedule();
  };

  $scope.toggle_show_loan_schedule = function () {
    if ($scope.schedule.length > 0) $scope.show_loan_schedule = !$scope.show_loan_schedule;
  };

  $scope.open_loan_schedule = function () {
    if ($scope.schedule.length > 0 && $scope.show_loan_schedule == true) return true;else return false;
  };

  $scope.validate_loan_rate = function () {
    $scope.loan_start_month_warning = '';
    $scope.loan_rate_error = '';
    $scope.loan_rate_warning = '';
    var _$scope$form = $scope.form,
        custom = _$scope$form.custom,
        federal = _$scope$form.federal,
        start = _$scope$form.start; // error validation

    var _$scope$loan = $scope.loan,
        custom_rate = _$scope$loan.custom_rate,
        federal_rate = _$scope$loan.federal_rate,
        start_month = _$scope$loan.start_month; // form values

    if (start.$touched && !start_month) $scope.loan_start_month_warning = 'If you don\'t choose a starting month, current month will be applied';
    if (custom.$pristine && federal.$pristine) $scope.loan_rate_error = '';else {
      if ((!custom_rate || custom_rate <= 0) && !federal_rate) $scope.loan_rate_error = 'Please either fill out the custom rate or select an option';
      if (custom_rate > 0 && federal_rate) $scope.loan_rate_warning = 'If you choose both interests, custom interest will be applied';
    }
  };

  $scope.calculate_schedule = function () {
    var _$scope$loan2 = $scope.loan,
        amount = _$scope$loan2.amount,
        start_month = _$scope$loan2.start_month,
        number_of_months = _$scope$loan2.number_of_months,
        custom_rate = _$scope$loan2.custom_rate,
        federal_rate = _$scope$loan2.federal_rate;

    if (+amount > 0 && +number_of_months > 0 && (+custom_rate > 0 || federal_rate > 0)) {
      $scope.schedule = LoanFactory.calculate_schedule($scope.loan);
      $scope.subtotal_payment = $scope.schedule.map(function (s) {
        return +s.payment;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);
      $scope.subtotal_principal = $scope.schedule.map(function (s) {
        return +s.principal;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);
      $scope.subtotal_interest = $scope.schedule.map(function (s) {
        return +s.interest;
      }).reduce(function (prev, curr) {
        return prev + curr;
      }, 0);

      $scope.result.est_payment = $scope.schedule[0].payment;
      $scope.result.subtotal_principal = $scope.subtotal_principal;
      $scope.result.subtotal_interest = $scope.subtotal_interest;
    }
  };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInN0YXRlcy5qcyIsImZhY3Rvcmllcy9sb2FuLmZhY3RvcnkuanMiLCJmYWN0b3JpZXMvcmF0ZS5mYWN0b3J5LmpzIiwiY29udHJvbGxlcnMvbWFpbi5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIm90aGVyd2lzZSIsInJ1biIsIiRyb290U2NvcGUiLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJ0aHJvd25FcnJvciIsImNvbnNvbGUiLCJpbmZvIiwibmFtZSIsImVycm9yIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsInZpZXdzIiwidGVtcGxhdGVVcmwiLCJjb25yb2xsZXIiLCJjb250cm9sbGVyIiwiZmFjdG9yeSIsIiRodHRwIiwiJGxvZyIsImNhbGN1bGF0ZV9zY2hlZHVsZSIsImxvYW4iLCJkIiwiRGF0ZSIsImRlZmF1bHRfc3RhcnRfbW9udGgiLCJzZXREYXRlIiwiZ2V0TW9udGgiLCJ1Iiwic3RhcnRfbW9udGgiLCJzY2hlZHVsZSIsIm0iLCJudW1iZXJfb2ZfbW9udGhzIiwiYW1vdW50IiwiciIsImN1c3RvbV9yYXRlIiwiZmVkZXJhbF9yYXRlIiwiYW5udWl0eV9mYWN0b3IiLCJNYXRoIiwicG93IiwicG10IiwibW9udGhzIiwiYmFsYW5jZSIsInBhaWRfcHJpbmNpcGFsIiwieSIsImkiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJtb250aCIsImludGVyZXN0IiwidG9GaXhlZCIsInByaW5jaXBhbCIsInBheW1lbnQiLCJOdW1iZXIiLCJwdXNoIiwicmF0ZXMiLCJmZXRjaF9yYXRlcyIsImxlbmd0aCIsImdldCIsInRoZW4iLCJyZXMiLCJkYXRhIiwidXBkYXRlZF9hdCIsIiRzY29wZSIsIlJhdGVGYWN0b3J5IiwiTG9hbkZhY3RvcnkiLCJkZWZhdWx0X2xvYW5fZm9ybSIsImZlZGVyYWwiLCJjdXN0b20iLCJkZWZhdWx0X2xvYW5fc2NoZWR1bGUiLCJkZWZhdWx0X3Jlc3VsdCIsImVzdF9wYXltZW50Iiwic3VidG90YWxfcHJpbmNpcGFsIiwic3VidG90YWxfaW50ZXJlc3QiLCJyZXNldCIsImNvcHkiLCJyZXN1bHQiLCJzaG93X2xvYW5fc2NoZWR1bGUiLCJsb2FuX3N0YXJ0X21vbnRoX3dhcm5pbmciLCJsb2FuX3JhdGVfZXJyb3IiLCJsb2FuX3JhdGVfd2FybmluZyIsImZvcm0iLCIkc2V0UHJpc3RpbmUiLCIkc2V0VW50b3VjaGVkIiwidXBkYXRlIiwidmFsaWRhdGVfbG9hbl9yYXRlIiwidG9nZ2xlX3Nob3dfbG9hbl9zY2hlZHVsZSIsIm9wZW5fbG9hbl9zY2hlZHVsZSIsInN0YXJ0IiwiJHRvdWNoZWQiLCIkcHJpc3RpbmUiLCJzdWJ0b3RhbF9wYXltZW50IiwibWFwIiwicyIsInJlZHVjZSIsInByZXYiLCJjdXJyIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLE1BQUFDLFFBQUFDLE1BQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQSxXQUFBLEVBQUEsV0FBQSxDQUFBLENBQUE7O0FBRUFGLElBQUFHLE1BQUEsQ0FBQSxVQUFBQyxrQkFBQSxFQUFBQyxpQkFBQSxFQUFBO0FBQ0FBLG9CQUFBQyxTQUFBLENBQUEsSUFBQTtBQUNBRixxQkFBQUcsU0FBQSxDQUFBLE9BQUE7QUFDQSxDQUhBOztBQUtBUCxJQUFBUSxHQUFBLENBQUEsVUFBQUMsVUFBQTtBQUFBLFNBQ0FBLFdBQUFDLEdBQUEsQ0FBQSxtQkFBQSxFQUFBLFVBQUFDLEtBQUEsRUFBQUMsT0FBQSxFQUFBQyxRQUFBLEVBQUFDLFNBQUEsRUFBQUMsVUFBQSxFQUFBQyxXQUFBLEVBQUE7QUFDQUMsWUFBQUMsSUFBQSxnRkFBQU4sUUFBQU8sSUFBQTtBQUNBRixZQUFBRyxLQUFBLENBQUFKLFdBQUE7QUFDQSxHQUhBLENBREE7QUFBQSxD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QUFBLENBQUE7QUFBQSxlQUFBLENBQUFDLEVBQUE1QyxRQUFBO0FBQUEsT0FBQSxFQUFBNkMsTUFBQSxDQUFBLFVBQUFDLElBQUEsRUFBQUMsSUFBQTtBQUFBLGVBQUFELE9BQUFDLElBQUE7QUFBQSxPQUFBLEVBQUEsQ0FBQSxDQUFBOztBQUVBakMsYUFBQWEsTUFBQSxDQUFBTCxXQUFBLEdBQUFSLE9BQUFqQyxRQUFBLENBQUEsQ0FBQSxFQUFBc0IsT0FBQTtBQUNBVyxhQUFBYSxNQUFBLENBQUFKLGtCQUFBLEdBQUFULE9BQUFTLGtCQUFBO0FBQ0FULGFBQUFhLE1BQUEsQ0FBQUgsaUJBQUEsR0FBQVYsT0FBQVUsaUJBQUE7QUFFQTtBQUVBLEdBZEE7QUFnQkEsQ0F2RUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHAnLCBbJ3VpLnJvdXRlcicsICduZ0FuaW1hdGUnXSk7XG5cbmFwcC5jb25maWcoKCR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpID0+IHtcbiAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvbWFpbicpO1xufSlcblxuYXBwLnJ1bigoJHJvb3RTY29wZSkgPT5cbiAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCB0aHJvd25FcnJvcikgPT4ge1xuICAgIGNvbnNvbGUuaW5mbyhgVGhlIGZvbGxvd2luZyBlcnJvciB3YXMgdGhyb3duIGJ5IHVpLXJvdXRlciB3aGlsZSB0cmFuc2l0aW9uaW5nIHRvIHN0YXRlIFwiJHt0b1N0YXRlLm5hbWV9XCIuIFRoZSBvcmlnaW4gb2YgdGhpcyBlcnJvciBpcyBwcm9iYWJseSBhIHJlc29sdmUgZnVuY3Rpb246YCk7XG4gICAgY29uc29sZS5lcnJvcih0aHJvd25FcnJvcik7XG4gIH0pXG4pXG4iLCIndXNlIHN0cmljdCdcblxuYXBwLmNvbmZpZygoJHN0YXRlUHJvdmlkZXIpID0+XG4gICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdtYWluJywge1xuICAgIHVybDogJy9tYWluJyxcbiAgICB2aWV3czoge1xuICAgICAgJyc6IHsgdGVtcGxhdGVVcmw6ICdzcmMvdGVtcGxhdGVzL21haW4udGVtcGxhdGUuaHRtbCcsIGNvbnJvbGxlcjogJ01haW5DdHJsJ30sXG4gICAgICAnYmdAbWFpbic6IHt0ZW1wbGF0ZVVybDogJ3NyYy90ZW1wbGF0ZXMvYmcudGVtcGxhdGUuaHRtbCd9LFxuICAgICAgJ2ludHJvQG1haW4nOiB7IHRlbXBsYXRlVXJsOiAnc3JjL3RlbXBsYXRlcy9pbnRyby50ZW1wbGF0ZS5odG1sJyB9LFxuICAgICAgJ2Zvcm1AbWFpbic6IHt0ZW1wbGF0ZVVybDogJ3NyYy90ZW1wbGF0ZXMvZm9ybS50ZW1wbGF0ZS5odG1sJywgY29udHJvbGxlcjogJ01haW5DdHJsJ30sXG4gICAgICAnZm9vdGVyQG1haW4nOiB7IHRlbXBsYXRlVXJsOiAnc3JjL3RlbXBsYXRlcy9mb290ZXIudGVtcGxhdGUuaHRtbCcgfVxuICAgIH1cbiAgfSlcbikiLCIndXNlIHN0cmljdCdcblxuYXBwLmZhY3RvcnkoJ0xvYW5GYWN0b3J5JywgKCRodHRwLCAkbG9nKSA9PiB7XG5cbiAgY29uc3QgY2FsY3VsYXRlX3NjaGVkdWxlID0gKGxvYW4pID0+IHtcbiAgICBjb25zdCBkID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBkZWZhdWx0X3N0YXJ0X21vbnRoID0gZC5zZXREYXRlKGQuZ2V0TW9udGgoKSArIDEpO1xuICAgIGNvbnN0IHUgPSBuZXcgRGF0ZShkZWZhdWx0X3N0YXJ0X21vbnRoKVxuICAgIGlmICghbG9hbi5zdGFydF9tb250aCkgbG9hbi5zdGFydF9tb250aCA9IHU7XG5cbiAgICBsZXQgc2NoZWR1bGUgPSBbXTtcbiAgICBsZXQgbSA9ICtsb2FuLm51bWJlcl9vZl9tb250aHM7XG4gICAgbGV0IGFtb3VudCA9ICtsb2FuLmFtb3VudDtcbiAgICBsZXQgciA9ICtsb2FuLmN1c3RvbV9yYXRlID4gMCA/ICtsb2FuLmN1c3RvbV9yYXRlIC8gMTAwIDogK2xvYW4uZmVkZXJhbF9yYXRlO1xuICAgIGNvbnN0IGFubnVpdHlfZmFjdG9yID0gKDEgLSAxLyBNYXRoLnBvdygxICsgci9tLCBtKSkgLyAoci9tKTtcbiAgICBjb25zdCBwbXQgPSBhbW91bnQgLyBhbm51aXR5X2ZhY3RvcjtcbiAgICBjb25zdCBtb250aHMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcblxuICAgIGxldCBiYWxhbmNlID0gYW1vdW50O1xuICAgIGxldCBwYWlkX3ByaW5jaXBhbCA9IDA7XG4gICAgbGV0IHkgPSAwO1xuICAgIGZvcih2YXIgaT0wOyBpPG07IGkrKykge1xuICAgICAgaWYgKCAobG9hbi5zdGFydF9tb250aC5nZXRNb250aCgpICsgaSkgJSAxMiA9PSAxMSApIHkgKz0xO1xuICAgICAgbGV0IHllYXIgPSBsb2FuLnN0YXJ0X21vbnRoLmdldEZ1bGxZZWFyKCkgKyB5IDtcbiAgICAgIGxldCBtb250aCA9IGAke21vbnRoc1sobG9hbi5zdGFydF9tb250aC5nZXRNb250aCgpICsgaSsxKSAlIDEyIF19LSR7eWVhcn1gO1xuICAgICAgaWYgKGkgPT0gbS0xKSB7XG4gICAgICAgIGxldCBpbnRlcmVzdCA9IChiYWxhbmNlICogKHIvbSkpLnRvRml4ZWQoMik7XG4gICAgICAgIGxldCBwcmluY2lwYWwgPSAoYW1vdW50IC0gcGFpZF9wcmluY2lwYWwpLnRvRml4ZWQoMik7XG4gICAgICAgIGxldCBwYXltZW50ID0gKE51bWJlcihpbnRlcmVzdCkgKyBOdW1iZXIocHJpbmNpcGFsKSkudG9GaXhlZCgyKTtcbiAgICAgICAgYmFsYW5jZSA9IDA7XG4gICAgICAgIHNjaGVkdWxlLnB1c2goeyBtb250aCwgcGF5bWVudCwgcHJpbmNpcGFsLCBpbnRlcmVzdCwgYmFsYW5jZSB9KVxuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBsZXQgcGF5bWVudCA9IHBtdC50b0ZpeGVkKDIpO1xuICAgICAgICBsZXQgaW50ZXJlc3QgPSAoYmFsYW5jZSAqIChyL20pKS50b0ZpeGVkKDIpO1xuICAgICAgICBsZXQgcHJpbmNpcGFsID0gKHBheW1lbnQgLSBiYWxhbmNlICogKHIvbSkpLnRvRml4ZWQoMik7XG4gICAgICAgIHBhaWRfcHJpbmNpcGFsICs9IE51bWJlcihwcmluY2lwYWwpO1xuICAgICAgICBiYWxhbmNlID0gKGJhbGFuY2UgLSBwcmluY2lwYWwpLnRvRml4ZWQoMik7XG4gICAgICAgIHNjaGVkdWxlLnB1c2goeyBtb250aCwgcGF5bWVudCwgcHJpbmNpcGFsLCBpbnRlcmVzdCwgYmFsYW5jZSB9KVxuICAgICAgfVxuXG4gICAgfVxuICAgIHJldHVybiBzY2hlZHVsZTtcbiAgfVxuXG5cbiAgcmV0dXJuIHsgY2FsY3VsYXRlX3NjaGVkdWxlIH1cbn0pXG4iLCIndXNlIHN0cmljdCdcblxuYXBwLmZhY3RvcnkoJ1JhdGVGYWN0b3J5JywgKCRodHRwLCAkbG9nKSA9PiB7XG4gIGxldCByYXRlcyA9IFtdO1xuXG4gIGNvbnN0IGZldGNoX3JhdGVzID0gKCkgPT4ge1xuICAgIGlmIChyYXRlcy5sZW5ndGggPT0gMCkgcmV0dXJuICRodHRwLmdldCgnL2FwaS9yYXRlcycpLnRoZW4ocmVzID0+IHJhdGVzID0gcmVzLmRhdGEpO1xuICAgIGVsc2UgaWYgKG5ldyBEYXRlIC0gcmF0ZXNbMF0udXBkYXRlZF9hdCA+IDI0ICogNjAgKiA2MCAqIDEwMDApIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcmF0ZXMnKS50aGVuKHJlcyA9PiByYXRlcyA9IHJlcy5kYXRhKTtcbiAgICByZXR1cm4gcmF0ZXM7XG4gIH1cblxuICByZXR1cm4geyBmZXRjaF9yYXRlcyB9XG59KVxuIiwiJ3VzZSBzdHJpY3QnXG5cbmFwcC5jb250cm9sbGVyKCdNYWluQ3RybCcsICgkc2NvcGUsIFJhdGVGYWN0b3J5LCBMb2FuRmFjdG9yeSkgPT4ge1xuXG4gIFJhdGVGYWN0b3J5LmZldGNoX3JhdGVzKCkudGhlbihkYXRhID0+ICRzY29wZS5yYXRlcyA9IGRhdGEpO1xuXG4gICRzY29wZS5kZWZhdWx0X2xvYW5fZm9ybSA9IHsgYW1vdW50OiAnJywgc3RhcnRfbW9udGg6ICcnLCBudW1iZXJfb2ZfbW9udGhzOiAnJywgY3VzdG9tX3JhdGU6ICcnLCBmZWRlcmFsX3JhdGU6ICcnLCBmZWRlcmFsOiAnJywgY3VzdG9tOiAnJyB9O1xuICAkc2NvcGUuZGVmYXVsdF9sb2FuX3NjaGVkdWxlID0gW107XG4gICRzY29wZS5kZWZhdWx0X3Jlc3VsdCA9IHsgZXN0X3BheW1lbnQ6ICcnLCBzdWJ0b3RhbF9wcmluY2lwYWw6ICcnLCBzdWJ0b3RhbF9pbnRlcmVzdDogJyd9O1xuXG5cbiAgJHNjb3BlLnJlc2V0ID0gKCkgPT4ge1xuICAgICRzY29wZS5sb2FuID0gYW5ndWxhci5jb3B5KCRzY29wZS5kZWZhdWx0X2xvYW5fZm9ybSk7XG4gICAgJHNjb3BlLnNjaGVkdWxlID0gYW5ndWxhci5jb3B5KCRzY29wZS5kZWZhdWx0X2xvYW5fc2NoZWR1bGUpO1xuICAgICRzY29wZS5yZXN1bHQgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmRlZmF1bHRfcmVzdWx0KTtcbiAgICAkc2NvcGUuc2hvd19sb2FuX3NjaGVkdWxlID0gZmFsc2U7XG4gICAgJHNjb3BlLmxvYW5fc3RhcnRfbW9udGhfd2FybmluZyA9ICcnO1xuICAgICRzY29wZS5sb2FuX3JhdGVfZXJyb3IgPSAnJztcbiAgICAkc2NvcGUubG9hbl9yYXRlX3dhcm5pbmcgPSAnJztcbiAgICBpZiAoJHNjb3BlLmZvcm0pIHtcbiAgICAgICRzY29wZS5mb3JtLiRzZXRQcmlzdGluZSgpO1xuICAgICAgJHNjb3BlLmZvcm0uJHNldFVudG91Y2hlZCgpO1xuICAgIH1cbiAgfVxuICAkc2NvcGUucmVzZXQoKTtcblxuICAkc2NvcGUudXBkYXRlID0gKCkgPT4ge1xuICAgIC8vVE9ETzogbW9uZXkgdmFsdWUgZm9ybWF0IC8vIGNvbnN0IGZvcm1hdCA9IChuLCBjdXJyZW5jeSkgPT4gY3VycmVuY3kgKyBcIiBcIiArIE51bWJlcihuKS50b0ZpeGVkKDIpLnJlcGxhY2UoLyhcXGQpKD89KFxcZHszfSkrXFwuKS9nLCAnJDEsJyk7XG4gICAgJHNjb3BlLnZhbGlkYXRlX2xvYW5fcmF0ZSgpO1xuICAgICRzY29wZS5jYWxjdWxhdGVfc2NoZWR1bGUoKTtcbiAgfVxuXG4gICRzY29wZS50b2dnbGVfc2hvd19sb2FuX3NjaGVkdWxlID0gKCkgPT4ge1xuICAgIGlmICgkc2NvcGUuc2NoZWR1bGUubGVuZ3RoID4gMCkgJHNjb3BlLnNob3dfbG9hbl9zY2hlZHVsZSA9ICEkc2NvcGUuc2hvd19sb2FuX3NjaGVkdWxlO1xuICB9XG5cbiAgJHNjb3BlLm9wZW5fbG9hbl9zY2hlZHVsZSA9ICgpID0+IHtcbiAgICBpZiAoJHNjb3BlLnNjaGVkdWxlLmxlbmd0aCA+IDAgJiYgJHNjb3BlLnNob3dfbG9hbl9zY2hlZHVsZSA9PSB0cnVlKSByZXR1cm4gdHJ1ZTtcbiAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgfVxuXG5cbiAgJHNjb3BlLnZhbGlkYXRlX2xvYW5fcmF0ZSA9ICgpID0+IHtcbiAgICAkc2NvcGUubG9hbl9zdGFydF9tb250aF93YXJuaW5nID0gJyc7XG4gICAgJHNjb3BlLmxvYW5fcmF0ZV9lcnJvciA9ICcnO1xuICAgICRzY29wZS5sb2FuX3JhdGVfd2FybmluZyA9ICcnO1xuICAgIGNvbnN0IHsgY3VzdG9tLCBmZWRlcmFsLCBzdGFydCB9ID0gJHNjb3BlLmZvcm07IC8vIGVycm9yIHZhbGlkYXRpb25cbiAgICBjb25zdCB7IGN1c3RvbV9yYXRlLCBmZWRlcmFsX3JhdGUsIHN0YXJ0X21vbnRoIH0gPSAkc2NvcGUubG9hbjsgLy8gZm9ybSB2YWx1ZXNcblxuICAgIGlmIChzdGFydC4kdG91Y2hlZCAmJiAhc3RhcnRfbW9udGgpICRzY29wZS5sb2FuX3N0YXJ0X21vbnRoX3dhcm5pbmcgPSBgSWYgeW91IGRvbid0IGNob29zZSBhIHN0YXJ0aW5nIG1vbnRoLCBjdXJyZW50IG1vbnRoIHdpbGwgYmUgYXBwbGllZGBcbiAgICBpZiAoY3VzdG9tLiRwcmlzdGluZSAmJiBmZWRlcmFsLiRwcmlzdGluZSkgJHNjb3BlLmxvYW5fcmF0ZV9lcnJvciA9ICcnO1xuICAgIGVsc2Uge1xuICAgICAgaWYgKCghY3VzdG9tX3JhdGUgfHwgY3VzdG9tX3JhdGUgPD0gMCkgJiYgIWZlZGVyYWxfcmF0ZSkgJHNjb3BlLmxvYW5fcmF0ZV9lcnJvciA9ICdQbGVhc2UgZWl0aGVyIGZpbGwgb3V0IHRoZSBjdXN0b20gcmF0ZSBvciBzZWxlY3QgYW4gb3B0aW9uJztcbiAgICAgIGlmIChjdXN0b21fcmF0ZSA+IDAgJiYgZmVkZXJhbF9yYXRlKSAkc2NvcGUubG9hbl9yYXRlX3dhcm5pbmcgPSAnSWYgeW91IGNob29zZSBib3RoIGludGVyZXN0cywgY3VzdG9tIGludGVyZXN0IHdpbGwgYmUgYXBwbGllZCc7XG4gICAgfVxuICB9XG5cbiAgJHNjb3BlLmNhbGN1bGF0ZV9zY2hlZHVsZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IGFtb3VudCwgc3RhcnRfbW9udGgsIG51bWJlcl9vZl9tb250aHMsIGN1c3RvbV9yYXRlLCBmZWRlcmFsX3JhdGUgfSA9ICRzY29wZS5sb2FuO1xuICAgIGlmICgrYW1vdW50ID4gMCAmJiArbnVtYmVyX29mX21vbnRocyA+IDAgJiYgKCtjdXN0b21fcmF0ZSA+IDAgfHwgZmVkZXJhbF9yYXRlID4gMCkgKSB7XG4gICAgICAkc2NvcGUuc2NoZWR1bGUgPSBMb2FuRmFjdG9yeS5jYWxjdWxhdGVfc2NoZWR1bGUoJHNjb3BlLmxvYW4pO1xuICAgICAgJHNjb3BlLnN1YnRvdGFsX3BheW1lbnQgPSAkc2NvcGUuc2NoZWR1bGUubWFwKHMgPT4gK3MucGF5bWVudCkucmVkdWNlKChwcmV2LCBjdXJyKSA9PiBwcmV2ICsgY3VyciwgMCk7XG4gICAgICAkc2NvcGUuc3VidG90YWxfcHJpbmNpcGFsID0gJHNjb3BlLnNjaGVkdWxlLm1hcChzID0+ICtzLnByaW5jaXBhbCkucmVkdWNlKChwcmV2LCBjdXJyKSA9PiBwcmV2ICsgY3VyciwgMCk7XG4gICAgICAkc2NvcGUuc3VidG90YWxfaW50ZXJlc3QgPSAkc2NvcGUuc2NoZWR1bGUubWFwKHMgPT4gK3MuaW50ZXJlc3QpLnJlZHVjZSgocHJldiwgY3VycikgPT4gcHJldiArIGN1cnIsIDApO1xuXG4gICAgICAkc2NvcGUucmVzdWx0LmVzdF9wYXltZW50ID0gJHNjb3BlLnNjaGVkdWxlWzBdLnBheW1lbnQ7XG4gICAgICAkc2NvcGUucmVzdWx0LnN1YnRvdGFsX3ByaW5jaXBhbCA9ICRzY29wZS5zdWJ0b3RhbF9wcmluY2lwYWw7XG4gICAgICAkc2NvcGUucmVzdWx0LnN1YnRvdGFsX2ludGVyZXN0ID0gJHNjb3BlLnN1YnRvdGFsX2ludGVyZXN0O1xuXG4gICAgfVxuXG4gIH1cblxufSkiXX0=
